<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thi thá»­ TNTV cáº¥p Tá»‰nh nÄƒm 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .question-nav-btn.active { border: 3px solid #ef4444; }
        .question-nav-btn.answered { background-color: #22c55e !important; color: white; }
        .drop-zone { min-height: 55px; border: 2px dashed #cbd5e1; border-radius: 12px; padding: 8px; margin-top: 8px; background: #f8fafc; transition: all 0.3s; }
        .drag-item { cursor: grab; padding: 10px 16px; background: white; border: 1px solid #e2e8f0; border-radius: 8px; margin-bottom: 4px; display: inline-block; box-shadow: 0 2px 4px rgba(0,0,0,0.05); font-weight: 500; }
        .drag-item:active { cursor: grabbing; }
        .hidden-screen { display: none !important; }
        .inline-input { display: inline-block; width: 100px; padding: 2px 8px; border-bottom: 2px solid #3b82f6; outline: none; text-align: center; font-weight: bold; color: #1e40af; background: #f1f5f9; border-radius: 4px; transition: all 0.2s; margin: 0 2px; }
        .inline-input:focus { background-color: #dbeafe; border-bottom-color: #1d4ed8; transform: translateY(-1px); }
        .question-text { line-height: 2.4; font-size: 1.15rem; }
        .error-label { font-size: 0.8rem; font-weight: 800; color: #dc2626; text-transform: uppercase; margin-bottom: 6px; display: block; }
    </style>
</head>
<body class="bg-slate-100 font-sans text-slate-800">

<div id="app" class="max-w-6xl mx-auto p-4 min-h-screen">
    <!-- Login Screen -->
    <div id="login-screen" class="flex flex-col items-center justify-center mt-20 bg-white p-10 rounded-2xl shadow-xl max-w-md mx-auto border border-slate-200">
        <h1 class="text-2xl font-bold text-blue-800 mb-8 text-center uppercase tracking-tight">Thi thá»­ TNTV cáº¥p Tá»‰nh nÄƒm 2026</h1>
        <div class="w-full mb-6">
            <label class="block text-sm font-semibold mb-2 text-slate-600">Sá»‘ bÃ¡o danh cá»§a em:</label>
            <input type="text" id="student-id" class="w-full p-4 border-2 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none transition" placeholder="SBD gá»“m 8 sá»‘">
        </div>
        <button onclick="window.handleLogin()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition">ÄÄƒng nháº­p há»‡ thá»‘ng</button>
        <p id="login-error" class="text-red-500 text-sm mt-4 hidden font-medium text-center">âš ï¸ Sá»‘ bÃ¡o danh khÃ´ng chÃ­nh xÃ¡c! (nháº­p ngÃ y thÃ¡ng nÄƒm sinh theo Ä‘á»‹nh dáº¡ng ddmmyyyy</p>
    </div>

    <!-- Ready Screen -->
    <div id="ready-screen" class="hidden-screen flex flex-col items-center justify-center mt-20 bg-white p-10 rounded-2xl shadow-xl max-w-md mx-auto border border-slate-200">
        <h2 id="welcome-msg" class="text-2xl font-bold mb-4 text-center text-blue-900"></h2>
        <div class="mb-8 p-5 bg-blue-50 rounded-xl text-center text-slate-700 space-y-2 w-full">
            <p>Ná»™i dung: <b>30 cÃ¢u há»i ngáº«u nhiÃªn</b></p>
            <p>Thá»i gian lÃ m bÃ i: <b>30 phÃºt</b></p>
            <p>Äiá»ƒm tá»‘i Ä‘a: <b>300 Ä‘iá»ƒm</b></p>
        </div>
        <p class="mb-8 text-xl font-bold text-slate-800 text-center">Em Ä‘Ã£ sáºµn sÃ ng chÆ°a?</p>
        <div class="flex gap-4 w-full">
            <button onclick="window.startExam()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition">Em sáºµn sÃ ng</button>
            <button onclick="location.reload()" class="flex-1 bg-slate-200 text-slate-700 font-bold py-4 rounded-xl hover:bg-slate-300 transition">Em chÆ°a sáºµn sÃ ng</button>
        </div>
    </div>

    <!-- Exam Screen -->
    <div id="exam-screen" class="hidden-screen">
        <header class="flex flex-wrap justify-between items-center bg-white p-5 rounded-2xl shadow-md mb-6 sticky top-0 z-20 border-b-4 border-blue-600">
            <div>
                <h1 class="text-xl font-black text-blue-800 tracking-tight uppercase">TNTV Cáº¥p Tá»‰nh 2026</h1>
                <p class="text-sm font-medium">Há»c sinh: <span id="display-name" class="text-green-600 font-bold"></span></p>
            </div>
            <div class="flex items-center gap-6">
                <div class="text-3xl font-mono font-black text-red-600 bg-red-50 px-5 py-2 rounded-xl border border-red-200" id="timer">30:00</div>
                <button onclick="window.confirmSubmit()" class="bg-blue-600 text-white px-8 py-2 rounded-full font-bold shadow-lg hover:bg-blue-700 transition">Ná»™p bÃ i</button>
            </div>
        </header>

        <div class="flex flex-col lg:flex-row gap-8">
            <div class="flex-1">
                <div id="question-area" class="bg-white p-8 rounded-3xl shadow-sm min-h-[500px] border border-slate-200">
                    <div id="question-container"></div>
                </div>
                <div class="flex justify-between mt-8">
                    <button id="prev-btn" onclick="window.navQuestion(-1)" class="bg-white border-2 border-slate-200 px-10 py-3 rounded-2xl font-bold hover:bg-slate-50 disabled:opacity-30 transition">CÃ¢u trÆ°á»›c</button>
                    <button id="next-btn" onclick="window.navQuestion(1)" class="bg-white border-2 border-slate-200 px-10 py-3 rounded-2xl font-bold hover:bg-slate-50 disabled:opacity-30 transition">CÃ¢u tiáº¿p theo</button>
                </div>
            </div>
            <div class="w-full lg:w-80">
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200 sticky top-32">
                    <h3 class="font-bold text-slate-500 mb-4 pb-2 border-b uppercase text-xs tracking-widest text-center">Danh sÃ¡ch cÃ¢u há»i</h3>
                    <div id="question-nav" class="grid grid-cols-5 gap-3"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Result Screen -->
    <div id="result-screen" class="hidden-screen flex-col items-center">
        <div class="bg-white p-12 rounded-[2.5rem] shadow-2xl text-center max-w-2xl w-full border-t-[12px] border-blue-600">
            <h2 class="text-3xl font-black text-slate-800 mb-2 uppercase">Káº¿t quáº£ thi</h2>
            <div class="text-8xl font-black text-blue-700 mb-6" id="final-score">0</div>
            <p id="result-summary" class="text-xl text-slate-600 mb-10 font-medium"></p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button onclick="window.showReview()" class="bg-blue-600 text-white px-10 py-4 rounded-2xl font-bold hover:bg-blue-700 shadow-xl transition-all">Xem láº¡i bÃ i lÃ m</button>
                <button onclick="location.reload()" class="bg-slate-100 text-slate-700 px-10 py-4 rounded-2xl font-bold hover:bg-slate-200 transition">ThoÃ¡t</button>
            </div>
            <div class="mt-12 text-left bg-slate-50 p-8 rounded-3xl border border-slate-200">
                <h3 class="font-black text-slate-700 mb-5 border-b pb-2 text-sm uppercase">Lá»‹ch sá»­ thi cá»§a em:</h3>
                <ul id="history-list" class="space-y-3"></ul>
            </div>
        </div>
    </div>
</div>

<!-- Review Modal -->
<div id="review-modal" class="hidden fixed inset-0 bg-slate-900/90 backdrop-blur-md z-[100] overflow-y-auto p-4 flex items-start justify-center">
    <div class="bg-white w-full max-w-4xl rounded-[2rem] p-10 shadow-2xl my-10 relative">
        <button onclick="window.closeReview()" class="absolute top-6 right-8 text-5xl font-light hover:text-red-500 transition">&times;</button>
        <h2 class="text-3xl font-black mb-10 text-blue-900 border-b pb-4 text-center">PhÃ¢n tÃ­ch káº¿t quáº£ chi tiáº¿t</h2>
        <div id="review-content" class="space-y-12 text-left"></div>
    </div>
</div>

<!-- Confirm Dialog -->
<div id="confirm-dialog" class="hidden fixed inset-0 bg-slate-900/70 backdrop-blur-sm z-[110] flex items-center justify-center p-4">
    <div class="bg-white p-10 rounded-[2rem] max-w-md w-full shadow-2xl text-center">
        <h3 class="text-2xl font-black text-slate-800 mb-4 tracking-tight">Ná»™p bÃ i ngay?</h3>
        <p class="text-slate-600 mb-8">Em hÃ£y kiá»ƒm tra ká»¹ cÃ¡c Ä‘Ã¡p Ã¡n trÆ°á»›c khi nháº¥n ná»™p bÃ i nhÃ©!</p>
        <div class="flex flex-col gap-4">
            <button onclick="window.submitExam()" class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-blue-200">Ná»™p bÃ i ngay</button>
            <button onclick="window.closeConfirm()" class="w-full bg-slate-100 text-slate-700 py-4 rounded-xl font-bold">Kiá»ƒm tra láº¡i</button>
        </div>
    </div>
</div>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';
import { getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';
import { getFirestore, collection, addDoc, query, onSnapshot, doc } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';

// --- INITIALIZE FIREBASE ---
let firebaseApp, firebaseDb, firebaseAuth;
const appId = typeof __app_id !== 'undefined' ? __app_id : 'tntv-2026-v8';

try {
    const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
    if (firebaseConfig.apiKey) {
        firebaseApp = initializeApp(firebaseConfig);
        firebaseDb = getFirestore(firebaseApp);
        firebaseAuth = getAuth(firebaseApp);
    }
} catch (e) {
    console.error("Firebase Initialization skipped or failed", e);
}

// --- DATA CÃ‚U Há»I ---
const allQuestions = [
    { id: 1, type: "fill", q: "Äiá»n â€œchâ€ hoáº·c â€œtrâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>â€œHai ...a con bÆ°á»›c Ä‘i trÃªn cÃ¡t Ãnh máº·t ...á»i rá»±c rá»¡ biá»ƒn xanh BÃ³ng ...a dÃ i lÃªnh khÃªnh BÃ³ng con ...Ã²n ...áº¯c ná»‹ch.â€ (HoÃ ng Trung ThÃ´ng)", ans: "ch, tr, ch, tr, ch" },
    { id: 2, type: "fill", q: "Äiá»n â€œchâ€ hoáº·c â€œtrâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>Dá»c ngang biáº¿t máº¥y náº»o Ä‘Æ°á»ng Tháº¯m ...ang sá»­ Viá»‡t, ráº¡ng ...Æ°Æ¡ng anh hÃ¹ng Bao nhiÃªu ...iáº¿n tháº¯ng láº«y lá»«ng LÃ m nÃªn Tá»• quá»‘c kiÃªu hÃ¹ng hÃ´m nay. (Nguyá»…n LÃ¢m Tháº¯ng)", ans: "tr, ch, ch" },
    { id: 3, type: "fill", q: "Äiá»n â€œxâ€ hoáº·c â€œsâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>Chá»‹ nháº£y vÃ o á»• lÃ¡ Náº±m ...uá»‘ng rá»“i Ä‘á»©ng lÃªn ChÃ¢n ...oay trÃ²n ...á»™t ...oáº¡t Má»™t há»“i má»›i náº±m yÃªn", ans: "x, x, s, s" },
    { id: 4, type: "fill", q: "Äiá»n â€œr/dâ€ hoáº·c â€œgiâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>YÃªu hÃ ng á»›t Ä‘Ã£ ...a hoa ÄÃ¡m ...Æ°a trá»• ná»¥, Ä‘Ã¡m cÃ  trá»• bÃ´ng. YÃªu sao tiáº¿ng máº¹ ...u ná»“ng, Tiáº¿ng thoi lÃ¡ch cÃ¡ch bÃªn nong ...Ã¢u táº±m. (LÃª Anh XuÃ¢n)", ans: "r, d, r, d" },
    { id: 5, type: "fill", q: "Äiá»n â€œxâ€ hoáº·c â€œsâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>Máº¹ Æ¡i tÃ³c báº¡c tuá»•i giÃ , Cáº¥y Ä‘Ãªm máº¹ váº«n ...Ã´ng pha cháº³ng ...á»n. NgÃ³n tay báº­t mÃ¡u máº£nh bom, Cáº¥y bao nhiÃªu máº¡, cÄƒm há»n báº¥y nhiÃªu. (LÃª Anh XuÃ¢n)", ans: "x, s" },
    { id: 6, type: "fill", q: "Äiá»n â€œr/dâ€ hoáº·c â€œgiâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>Bá»‘n máº·t quÃª hÆ°Æ¡ng ...áº£i phÃ³ng ...á»“i TÃ´i bá»—ng tháº¥y ná»™i tÃ´i tráº» láº¡i NhÆ° thá»i con gÃ¡i tuá»•i Ä‘Ã´i mÆ°Æ¡i NhÆ° hÃ ng ...á»«a trÆ°á»›c ngÃµ nhÃ  tÃ´i. (LÃª Anh XuÃ¢n)", ans: "gi, r, d" },
    { id: 7, type: "fill", q: "Äiá»n â€œr/dâ€ hoáº·c â€œgiâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>Bá» tre cÃµng tiáº¿ng sÃ¡o ...iá»u KhÃºc ...Ã¢n ca láº¡i dáº·t dÃ¬u lá»i ...u Bá»‘n mÃ¹a lÃ  bá»‘n cÃ¢u thÆ¡ Ngá»t ngÃ o ná»“ng áº¥m ...á»¯a bá» ca ...ao. (Theo Nguyá»…n LÃ¢m Tháº¯ng)", ans: "d, d, r, gi, d" },
    { id: 8, type: "fill", q: "Äiá»n â€œchâ€ hoáº·c â€œtrâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>NÃ²i ...e Ä‘Ã¢u ...á»‹u má»c cong ChÆ°a lÃªn Ä‘Ã£ nhá»n nhÆ° ...Ã´ng láº¡ thÆ°á»ng LÆ°ng ...áº§n phÆ¡i náº¯ng phÆ¡i sÆ°Æ¡ng CÃ³ manh Ã¡o cá»™c, ...e nhÆ°á»ng cho con. (Theo Nguyá»…n Duy)", ans: "tr, ch, ch, tr, tr" },
    { id: 9, type: "fill", q: "Äiá»n â€œr/dâ€ hoáº·c â€œgiâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>Viá»‡t Nam Ä‘áº¹p kháº¯p trÄƒm miá»n Bá»‘n mÃ¹a má»™t sáº¯c trá»i ...iÃªng Ä‘áº¥t nÃ y XÃ³m lÃ ng, Ä‘á»“ng ...uá»™ng, ...á»«ng cÃ¢y Non cao ...Ã³ ...á»±ng, sÃ´ng Ä‘áº§y náº¯ng chang. (Theo LÃª Anh XuÃ¢n)", ans: "r, r, r, gi, d" },
    { id: 10, type: "fill", q: "Äiá»n â€œchâ€ hoáº·c â€œtrâ€ vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n thÆ¡ sau: <br>Äáº§u ...á»i ngáº¥t Ä‘á»‰nh HÃ  Giang, CÃ  Mau mÅ©i Ä‘áº¥t má»¡ mÃ ng phÃ¹ sa TrÆ°á»ng SÆ¡n: ...Ã­ lá»›n Ã´ng ...a Cá»­u Long: lÃ²ng máº¹ bao la sÃ³ng ...Ã o. (Theo LÃª Anh XuÃ¢n)", ans: "tr, ch, ch, tr" },
    { id: 11, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: ÄÃªm mÆ°a, ngÃ y náº¯ng xÃ¡ gÃ¬, QuÃ¢n thÃ¹ cÃ²n Ä‘Ã³, ta Ä‘i chÆ°a vá». <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "xÃ¡ - sÃ¡" },
    { id: 12, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: Rá»«ng thu trÄƒng dá»i hÃ²a bÃ¬nh Nhá»› ai tiáº¿ng hÃ¡t Ã¢n tÃ¬nh thá»§y chung. (Theo Tá»‘ Há»¯u) <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "dá»i - rá»i" },
    { id: 13, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: Em yÃªu nhÃ  em HÃ ng xoan trÆ°á»›c ngÃµ Hoa xao xuyáº¿n ná»Ÿ NhÆ° mÃ¢y tá»«ng trÃ¹m. (Theo TÃ´ HÃ ) <br>Äoáº¡n thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "trÃ¹m - chÃ¹m" },
    { id: 14, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: Trong tráº¯ng mÃ  chang nghiÃªm HÆ°Æ¡ng ngÃ¡t dÃ i ngÃ y Ä‘Ãªm Nhá»› hoa giÃ u Ã¢n huá»‡ Gá»i xuÃ¢n vá» náº¯ng lÃªn. <br>Äoáº¡n thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "chang - trang" },
    { id: 15, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— cháº¥m: BÃ n tay lao Ä‘á»™ng Ta reo sá»± sá»‘ng TrÃªn tá»«ng Ä‘áº¥t khÃ´; BÃ n tay cáº§n cÃ¹ Máº·c dÃ¹ náº¯ng chÃ¡y Khoai trá»“ng tháº¯m ráº«y LÃºa cáº¥y xanh rá»«ng. (Theo HoÃ ng Trung ThÃ´ng) <br>Äoáº¡n thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "reo - gieo" },
    { id: 16, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: Äáº¥t quÃª hÆ°Æ¡ng nÃ¡t báº§m váº¿t Ä‘áº¡n ÄÃ£ nuÃ´i dá»«a nÄƒm thÃ¡ng xanh tÆ°Æ¡i Ã”i cÃ³ pháº£i dá»«a hÃºt bao cay Ä‘áº¯ng Äá»ƒ chá»• ra nhá»¯ng trÃ¡i ngá»t cho Ä‘á»i. (Theo LÃª Anh XuÃ¢n) <br>Äoáº¡n thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "chá»• - trá»•" },
    { id: 17, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: VÆ°Æ¡n mÃ¬nh trong giÃ³ che Ä‘u CÃ¢y kham khá»• váº«n hÃ¡t ru lÃ¡ cÃ nh. (Nguyá»…n Duy) <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "che - tre" },
    { id: 18, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: Anh em cÃ¹ng máº¹ khÃ¡c cha CÅ©ng nhÆ° cÃ¢y cá» xinh ra nhiá»u cÃ nh. <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "xinh - sinh" },
    { id: 19, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: Rá»… dá»«a bÃ¡m sÃ¢u vÃ o lÃ²ng Ä‘áº¥t NhÆ° dÃ¢n lÃ ng bÃ¡m tráº·t quÃª hÆ°Æ¡ng. <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "tráº·t - cháº·t" },
    { id: 20, type: "error_fix", q: "Äiá»n tá»« thÃ­ch há»£p vÃ o chá»— trá»‘ng: ÄÃ¢y con sÃ´ng xuÃ´i dÃ²ng nÆ°á»›c cháº£y Bá»‘n mÃ¹a xoi tá»«ng máº£ng mÃ¢y trá»i. (HoÃ i VÅ©) <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "xoi - soi" },
    { id: 21, type: "error_fix", q: "TÃ¬m nÆ¡i quáº§n Ä‘áº£o khÆ¡i sa CÃ³ loÃ i hoa ná»Ÿ nhÆ° lÃ  khÃ´ng tÃªn. (Nguyá»…n Äá»©c Máº­u) <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "sa - xa" },
    { id: 22, type: "error_fix", q: "CÃ¢u hÃ¡t cÄƒng buá»“m vá»›i giÃ³ khÆ¡i ÄoÃ n thuyá»n tráº¡y Ä‘ua cÃ¹ng máº·t trá»i. <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "tráº¡y - cháº¡y" },
    { id: 23, type: "error_fix", q: "NgÆ°á»i ngáº¯m trÄƒng soi ngoÃ i cá»­a xá»• TrÄƒng nhÃ²m khe cá»­a ngáº¯m nhÃ  thÆ¡. <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "xá»• - sá»•" },
    { id: 24, type: "error_fix", q: "Tá»« lÃ²ng khe háº¹p thung xa Suá»‘i giang tay hÃ¡t khÃºc ca há»£p Ä‘á»“ng. <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "giang - dang" },
    { id: 25, type: "error_fix", q: "NÃºi kia Ã´m chá»n biá»ƒn xanh Ta nhÆ° háº¡t cÃ¡t má»ng manh giá»¯a Ä‘á»i. <br>CÃ¢u thÆ¡ trÃªn cÃ³ tá»« ... viáº¿t sai chÃ­nh táº£, sá»­a láº¡i Ä‘Ãºng lÃ  ...", ans: "chá»n - trá»n" },
    { id: 26, type: "fill", q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>BÃ£o bÃ¹ng thÃ¢n ... láº¥y thÃ¢n <br>Tay Ã´m tay ... tre gáº§n nhau thÃªm. <br>ThÆ°Æ¡ng nhau tre cháº³ng á»Ÿ riÃªng, <br>LÅ©y thÃ nh tá»« Ä‘Ã³ mÃ  nÃªn há»¡i ngÆ°á»i. (Theo Nguyá»…n Duy)", ans: "bá»c, nÃ­u" },
    { id: 27, type: "fill", q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>Viá»‡t Nam Ä‘áº¥t nÆ°á»›c ta Æ¡i! <br>MÃªnh mÃ´ng biá»ƒn ... Ä‘Ã¢u trá»i Ä‘áº¹p hÆ¡n. <br>CÃ¡nh ... bay láº£ rá»£p rá»n, <br>MÃ¢y má» che Ä‘á»‰nh TrÆ°á»ng SÆ¡n sá»›m chiá»u. (Theo Nguyá»…n ÄÃ¬nh Thi)", ans: "lÃºa, cÃ²" },
    { id: 28, type: "fill", q: "Äiá»n tá»« ngá»¯ cÃ²n thiáº¿u vÃ o chá»— trá»‘ng trong Ä‘oáº¡n thÆ¡ sau: <br>ÄÃ¢y con sÃ´ng nhÆ° dÃ²ng sá»¯a máº¹ <br>NÆ°á»›c vá» xanh ruá»™ng lÃºa vÆ°á»n cÃ¢y <br>VÃ  áº¥m Ã¡p nhÆ° lÃ²ng ngÆ°á»i máº¹ <br>Chá»Ÿ ... trang tráº£i Ä‘Ãªm ngÃ y. (Theo HoÃ i VÅ©)", ans: "tÃ¬nh thÆ°Æ¡ng" },
    { id: 29, type: "fill", q: "Äá»c Ä‘oáº¡n thÆ¡ sau vÃ  Ä‘iá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>Máº¹ Æ¡i, trong lá»i máº¹ hÃ¡t <br>CÃ³ cáº£ cuá»™c Ä‘á»i hiá»‡n ra <br>Lá»i ru ... con Ä‘Ã´i cÃ¡nh <br>Lá»›n rá»“i con sáº½ bay xa. (Theo TrÆ°Æ¡ng Nam HÆ°Æ¡ng)", ans: "cháº¯p" },
    { id: 30, type: "mcq", q: "Chá»n cÃ¡c tiáº¿ng thÃ­ch há»£p láº§n lÆ°á»£t Ä‘iá»n vÃ o chá»— trá»‘ng trong Ä‘oáº¡n thÆ¡ sau: <br>HÃ  Ná»™i mÃ¹a nÃ y lÃ¡ vÃ ng rá»¥ng Ä‘áº§y sÃ¢n <br>Hoa [...] rÆ¡i ngáº­p ngá»«ng nÆ¡i gá»‘c phá»‘ <br>HÆ°Æ¡ng [...] vÃ²ng tá»a miÃªn man ná»—i nhá»› <br>Thu ghÃ© ngoÃ i hiÃªn, hoa [...] Ä‘Æ°á»£m vÃ ng. (Theo Nguyá»…n Lan HÆ°Æ¡ng)", options: ["A. sÆ°a â€“ cá»‘m â€“ mai", "B. ban â€“ sen â€“ Ä‘iá»‡p", "C. sá»¯a â€“ cá»‘m â€“ cÃºc"], ans: "C. sá»¯a â€“ cá»‘m â€“ cÃºc" },
    { id: 31, type: "fill", q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>YÃªu tá»«ng bá» ruá»™ng, lá»‘i mÃ²n <br>Äá» tÆ°Æ¡i bÃ´ng gáº¡o, biáº¿c rá»n ngÃ n dÃ¢u <br>YÃªu con sÃ´ng máº·t sÃ³ng xao <br>DÃ²ng sÃ´ng tuá»•i nhá» rÃ¬ rÃ o ... (Theo LÃª Anh XuÃ¢n)", ans: "hÃ¡t ca" },
    { id: 32, type: "fill", q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>TÃ´i lá»›n lÃªn Ä‘Ã£ tháº¥y dá»«a trÆ°á»›c ngÃµ <br>Dá»«a ru tÃ´i giáº¥c ngá»§ ... <br>Cá»© má»—i chiá»u nghe dá»«a reo trÆ°á»›c giÃ³ <br>TÃ´i há»i ná»™i tÃ´i: â€œDá»«a cÃ³ tá»± bao giá»?â€ (Theo LÃª Anh XuÃ¢n)", ans: "tuá»•i thÆ¡" },
    { id: 33, type: "fill", q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>Rá»«ng xa vá»ng tiáº¿ng chim gÃ¹, <br>NgÃ¢n nga tiáº¿ng suá»‘i, vi vu giÃ³ ngÃ n. <br>MÃ¹a xuÃ¢n Ä‘áº«m lÃ¡ ngá»¥y trang, <br>ÄÆ°á»ng ra ... ná»Ÿ vÃ ng hoa mai. (Theo LÃª Anh XuÃ¢n)", ans: "tiá»n tuyáº¿n" },
    { id: 34, type: "fill", q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>Ba lÃ´ náº·ng, sÃºng cáº§m tay, <br>ÄÆ°á»ng xa biáº¿t máº¥y ... nhá»› thÆ°Æ¡ng. <br>Giá» nÃ y máº¹ á»Ÿ quÃª hÆ°Æ¡ng, <br>CÅ©ng chá»«ng Ä‘ang dÃµi theo Ä‘Æ°á»ng ta Ä‘i. (Theo LÃª Anh XuÃ¢n)", ans: "dáº·m dÃ i" },
    { id: 35, type: "fill", q: "Äiá»n tá»« cÃ²n thiáº¿u vÃ o chá»— trá»‘ng: <br>Ã”i miá»n Báº¯c nÆ¡i lÃ²ng tÃ´i yÃªu quÃ½ <br>NÆ¡i bÃ¹ng lÃªn má»™t chÃ¢n lÃ½: ... <br>NÆ¡i Ä‘ang dá»±ng má»™t thiÃªn Ä‘Æ°á»ng hÃ¹ng vÄ© <br>NÆ¡i cÃ²n Ä‘Ã¢y di chá»‰ cá»§a ngÆ°á»i xÆ°a.", ans: "BÃ¡c Há»“" },
    { id: 36, type: "fill", q: "Äiá»n sá»‘ thÃ­ch há»£p vÃ o chá»— trá»‘ng: Tá»« cÃ¡c tiáº¿ng â€œgiÃºp, trá»£, cá»©u, Ä‘á»¡â€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "4" },
    { id: 37, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œthÃ nh, kiáº¿n, hÃ¬nh, thá»©câ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "5" },
    { id: 38, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œkhá»Ÿi, Ä‘á»™ng, lÆ°u, hÃ nhâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "5" },
    { id: 39, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œtÄ©nh, bÃ¬nh, yÃªn, láº·ngâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "8" },
    { id: 40, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œmong, trÃ´ng, chá», ngÃ³ngâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "8" },
    { id: 41, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œphÃ¡t, cháº¿, kiáº¿n, táº¡oâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "3" },
    { id: 42, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œcáº£m, tháº§n, tinh, thÃ´ngâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "5" },
    { id: 43, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œkhá»e, tÃ¢m, máº¡nh, sá»©câ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "5" },
    { id: 44, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œthanh, Ã¢m, Ä‘iá»‡u, phÃ¡tâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "6" },
    { id: 45, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œtiáº¿n, Ä‘á»“ng, hÃ nh, cá»­, Ä‘á»™ngâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "6" },
    { id: 46, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œthÆ°Æ¡ng, quÃ½, máº¿n, yÃªuâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "8" },
    { id: 47, type: "fill", q: "Tá»« cÃ¡c tiáº¿ng â€œhÃ nh, phÃ¡t, ban, báº£oâ€ cÃ³ thá»ƒ ghÃ©p Ä‘Æ°á»£c táº¥t cáº£ ... tá»«.", ans: "6" },
    { id: 48, type: "matching", q: "GhÃ©p tá»« á»Ÿ cá»™t bÃªn trÃ¡i vá»›i ná»™i dung thÃ­ch há»£p á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh cÃ¢u hoÃ n chá»‰nh.", items: ["thanh danh", "thanh Ä‘áº¡m", "thanh liÃªm", "thanh tra"], targets: ["Nhá»¯ng cá»‘ng hiáº¿n cá»§a anh áº¥y lÃ m ráº¡ng rá»¡ ... cá»§a cáº£ dÃ²ng tá»™c.", "Bá»¯a cÆ¡m bÃ  náº¥u tuy ... nhÆ°ng chan chá»©a tÃ¬nh thÆ°Æ¡ng áº¥m Ã¡p.", "TÃ´ Hiáº¿n ThÃ nh lÃ  má»™t vá»‹ quan ... chÃ­nh trá»±c.", "Äáº§u tuáº§n sau, trÆ°á»ng chÃºng ta sáº½ Ä‘Ã³n Ä‘oÃ n ... cá»§a tá»‰nh."], ans: { "thanh danh": 0, "thanh Ä‘áº¡m": 1, "thanh liÃªm": 2, "thanh tra": 3 } },
    { id: 49, type: "matching", q: "GhÃ©p tá»« á»Ÿ cá»™t bÃªn trÃ¡i vá»›i ná»™i dung thÃ­ch há»£p á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh cÃ¢u hoÃ n chá»‰nh.", items: ["phá»¥c kÃ­ch", "phá»¥c trang", "phá»¥c dá»±ng", "phá»¥c há»“i"], targets: ["ÄÃºng nhÆ° dá»± tÃ­nh, quÃ¢n giáº·c Ä‘Ã£ nhanh chÃ³ng rÆ¡i vÃ o tráº­n Ä‘á»‹a ... cá»§a quÃ¢n ta.", "ÄoÃ n lÃ m phim Ä‘Ã£ chuáº©n bá»‹ kÄ© lÆ°á»¡ng cÃ¡c Ä‘áº¡o cá»¥ vÃ  ... cho tá»«ng diá»…n viÃªn.", "Bá»™ phim Ä‘Ã£ ... bá»‘i cáº£nh chiáº¿n trÆ°á»ng trong nhá»¯ng nÄƒm khÃ¡ng chiáº¿n gian khá»•, Ã¡c liá»‡t.", "Sau má»™t thá»i gian Ä‘iá»u trá»‹ tÃ­ch cá»±c, sá»©c khá»e cá»§a Ã´ng áº¥y Ä‘Ã£ dáº§n ..."], ans: { "phá»¥c kÃ­ch": 0, "phá»¥c trang": 1, "phá»¥c dá»±ng": 2, "phá»¥c há»“i": 3 } },
    { id: 50, type: "matching", q: "GhÃ©p tá»« ngá»¯ á»Ÿ cá»™t bÃªn trÃ¡i vá»›i ná»™i dung thÃ­ch há»£p á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh cÃ¢u hoÃ n chá»‰nh.", items: ["tÃ¢m tráº¡ng", "tÃ¢m huyáº¿t", "tÃ¢m giao", "tÃ¢m há»“n"], targets: ["Má»—i khi ... khÃ´ng vui, cÃ´ áº¥y sáº½ nghe nhá»¯ng báº£n nháº¡c yÃªu thÃ­ch.", "CÃ´ áº¥y dá»“n háº¿t ... Ä‘á»ƒ sÃ¡ng táº¡o vÃ  phÃ¡t triá»ƒn dá»± Ã¡n má»›i.", "Anh áº¥y vÃ´ cÃ¹ng biáº¿t Æ¡n vÃ  trÃ¢n trá»ng ngÆ°á»i báº¡n ... cá»§a mÃ¬nh.", "SÃ¡ch lÃ  ngÆ°á»i báº¡n giÃºp bá»“i Ä‘áº¯p ... vÃ  trÃ­ tÆ°á»Ÿng tÆ°á»£ng cá»§a tráº» nhá»."], ans: { "tÃ¢m tráº¡ng": 0, "tÃ¢m huyáº¿t": 1, "tÃ¢m giao": 2, "tÃ¢m há»“n": 3 } },
    { id: 51, type: "matching", q: "GhÃ©p tá»« á»Ÿ cá»™t bÃªn trÃ¡i with ná»™i dung thÃ­ch há»£p á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh cÃ¢u hoÃ n chá»‰nh.", items: ["BÃ¬nh Ä‘áº³ng", "BÃ¬nh yÃªn", "BÃ¬nh tÃ¢m", "BÃ¬nh phá»¥c"], targets: ["Táº¥t cáº£ chÃºng ta Ä‘á»u ... vÃ  cáº§n tÃ´n trá»ng nhau.", "Äá»‘i vá»›i tÃ´i, quÃª ngoáº¡i thÃ¢n thÆ°Æ¡ng luÃ´n lÃ  nÆ¡i ... nháº¥t.", "Anh áº¥y tá»± nhá»§ pháº£i luÃ´n ... suy xÃ©t trong nhá»¯ng lÃºc nÃ³ng giáº­n.", "Sau má»™t thá»i gian tá»‹nh dÆ°á»¡ng, sá»©c khá»e cá»§a Ã´ng áº¥y Ä‘Ã£ dáº§n ..."], ans: { "BÃ¬nh Ä‘áº³ng": 0, "BÃ¬nh yÃªn": 1, "BÃ¬nh tÃ¢m": 2, "BÃ¬nh phá»¥c": 3 } },
    { id: 52, type: "matching", q: "GhÃ©p tá»« á»Ÿ cá»™t bÃªn trÃ¡i with ná»™i dung thÃ­ch há»£p á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh cÃ¢u hoÃ n chá»‰nh.", items: ["an cÆ°", "an ninh", "an khang", "an toÃ n"], targets: ["Sau bao nÄƒm bÃ´n ba, anh áº¥y trá»Ÿ vá» quÃª hÆ°Æ¡ng Ä‘á»ƒ ... láº¡c nghiá»‡p.", "CÃ¡c chÃº bá»™ Ä‘á»™i canh gÃ¡c nÆ¡i biÃªn cÆ°Æ¡ng Ä‘á»ƒ báº£o vá»‡ ... quá»‘c gia.", "Äáº§u xuÃ¢n nÄƒm má»›i, má»i ngÆ°á»i chÃºc nhau ... thá»‹nh vÆ°á»£ng.", "PhÆ°á»ng em phÃ¡t Ä‘á»™ng phong trÃ o â€œ... giao thÃ´ng vÃ¬ háº¡nh phÃºc má»i nhÃ â€."], ans: { "an cÆ°": 0, "an ninh": 1, "an khang": 2, "an toÃ n": 3 } },
    { id: 53, type: "matching", q: "Em hÃ£y ghÃ©p tá»« á»Ÿ cá»™t trÃ¡i with ná»™i dung tÆ°Æ¡ng á»©ng á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh má»™t cÃ¢u hoÃ n chá»‰nh.", items: ["cÃ´ng nháº­n", "cÃ´ng Æ°á»›c", "cÃ´ng báº±ng", "cÃ´ng Ã­ch"], targets: ["Nhá»¯ng báº±ng chá»©ng luáº­t sÆ° Ä‘Æ°a ra khÃ´ng Ä‘Æ°á»£c tháº©m phÃ¡n ...", "CÃ¡c quá»‘c gia Ä‘á»u tuÃ¢n thá»§ ... cá»§a LiÃªn há»£p quá»‘c vá» quyá»n tráº» em.", "ChÃºng tÃ´i sáº½ giáº£i quyáº¿t sá»± vá»¥ má»™t cÃ¡ch ... vÃ  nghiÃªm minh.", "Báº£o TrÃ¢m cÃ¹ng cÃ¡c báº¡n tham gia hoáº¡t Ä‘á»™ng ..."], ans: { "cÃ´ng nháº­n": 0, "cÃ´ng Æ°á»›c": 1, "cÃ´ng báº±ng": 2, "cÃ´ng Ã­ch": 3 } },
    { id: 54, type: "matching", q: "Ná»‘i tá»« ngá»¯ á»Ÿ cá»™t trÃ¡i with ná»™i dung tÆ°Æ¡ng á»©ng á»Ÿ cá»™t pháº£i Ä‘á»ƒ táº¡o thÃ nh má»™t cÃ¢u hoÃ n chá»‰nh.", items: ["thanh tÄ©nh", "thanh bÃ¬nh", "thanh tÃº", "thanh lá»‹ch"], targets: ["ÄÃªm khuya, khÃ´ng gian ... khiáº¿n tÃ´i dáº§n chÃ¬m vÃ o giáº¥c ngá»§.", "Báº¥t cá»© ai cÅ©ng mong muá»‘n cÃ³ Ä‘Æ°á»£c má»™t cuá»™c sá»‘ng ..., yÃªn vui.", "Ná»¥ cÆ°á»i ráº¡ng rá»¡ cÃ¹ng khuÃ´n máº·t ... cá»§a cÃ´ áº¥y Ä‘Ã£ Ä‘á»ƒ láº¡i áº¥n tÆ°á»£ng sÃ¢u Ä‘áº­m trong trÃ¡i tÃ´i.", "Ã”ng bÃ  tÃ´i luÃ´n giá»¯ gÃ¬n náº¿p sá»‘ng ... cá»§a con ngÆ°á»i HÃ  Ná»™i."], ans: { "thanh tÄ©nh": 0, "thanh bÃ¬nh": 1, "thanh tÃº": 2, "thanh lá»‹ch": 3 } },
    { id: 55, type: "matching", q: "GhÃ©p tá»« á»Ÿ cá»™t bÃªn trÃ¡i with ná»™i dung tÆ°Æ¡ng á»©ng á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh má»™t cÃ¢u hoÃ n chá»‰nh.", items: ["tÃ i trÃ­", "tÃ i Ä‘á»©c", "tÃ i nÄƒng", "tÃ i hoa"], targets: ["Báº±ng ... hÆ¡n ngÆ°á»i, anh áº¥y Ä‘Ã£ suy luáº­n ra nhá»¯ng Ä‘iá»ƒm khÃ¡c thÆ°á»ng mÃ  khÃ´ng ai phÃ¡t hiá»‡n Ä‘Æ°á»£c.", "Thá»§ lÄ©nh cá»§a chÃºng tÃ´i lÃ  má»™t ngÆ°á»i ... song toÃ n.", "Há»c viá»‡n thanh nháº¡c Ä‘Ã£ phÃ¡t hiá»‡n vÃ  bá»“i dÆ°á»¡ng ... cá»§a Há»“ng Anh.", "NgÆ°á»i Ä‘áº¿n xem triá»ƒn lÃ£m khÃ´ng khá»i tráº§m trá»“ trÆ°á»›c nhá»¯ng nÃ©t cháº¡m trá»• ... cá»§a cÃ¡c nghá»‡ nhÃ¢n."], ans: { "tÃ i trÃ­": 0, "tÃ i Ä‘á»©c": 1, "tÃ i nÄƒng": 2, "tÃ i hoa": 3 } },
    { id: 56, type: "matching", q: "GhÃ©p tá»« á»Ÿ cá»™t bÃªn trÃ¡i with ná»™i dung tÆ°Æ¡ng á»©ng á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh má»™t cÃ¢u hoÃ n chá»‰nh.", items: ["bÃ¬nh minh", "bÃ¬nh báº§u", "bÃ¬nh tÄ©nh", "bÃ¬nh an"], targets: ["MuÃ´n loÃ i hoa Ä‘ua nhau khoe sáº¯c, tá»a hÆ°Æ¡ng dÆ°á»›i Ã¡nh ...", "Cáº£ lá»›p Ä‘ang ... Ä‘á»ƒ tÃ¬m ra â€œSao chÄƒm ngoanâ€ thÃ¡ng 3.", "CÃ´ giÃ¡o chÃºc cáº£ lá»›p ..., tá»± tin vÃ  lÃ m bÃ i tháº­t tá»‘t.", "NÄƒm má»›i, con chÃ¡u chÃºc Ã´ng bÃ  luÃ´n máº¡nh khá»e vÃ  ..."], ans: { "bÃ¬nh minh": 0, "bÃ¬nh báº§u": 1, "bÃ¬nh tÄ©nh": 2, "bÃ¬nh an": 3 } },
    { id: 57, type: "matching", q: "Em hÃ£y ghÃ©p tá»« á»Ÿ cá»™t trÃ¡i with ná»™i dung tÆ°Æ¡ng á»©ng á»Ÿ cá»™t bÃªn pháº£i Ä‘á»ƒ táº¡o thÃ nh má»™t cÃ¢u hoÃ n chá»‰nh.", items: ["cÃ´ng cá»™ng", "cÃ´ng tÃ¢m", "cÃ´ng lÃ­", "cÃ´ng dÃ¢n"], targets: ["ChÃºng ta cáº§n chung tay giá»¯ gÃ¬n vá»‡ sinh nÆ¡i ...", "CÃ´ giÃ¡o Ä‘Ã£ Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh vÃ´ cÃ¹ng ..., khÃ´ng thiÃªn vá»‹ báº¡n nÃ o.", "Viá»‡t Nam lÃ  má»™t dÃ¢n tá»™c yÃªu chuá»™ng hÃ²a bÃ¬nh vÃ  ...", "ChÃºng tÃ´i tá»± hÃ o lÃ  ... cá»§a nÆ°á»›c Viá»‡t Nam."], ans: { "cÃ´ng cá»™ng": 0, "cÃ´ng tÃ¢m": 1, "cÃ´ng lÃ­": 2, "cÃ´ng dÃ¢n": 3 } },
    { id: 58, type: "mcq_multi", q: "Chá»n tá»« ngá»¯ thÃ­ch há»£p Ä‘iá»n vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n vÄƒn miÃªu táº£ hÃ¬nh áº£nh sau: <br>BÃ¬nh minh, máº·t trá»i tá»« tá»« nhÃ´ lÃªn sau dÃ£y nÃºi phÃ­a xa. Nhá»¯ng tia náº¯ng ... hiá»n hÃ²a Ä‘Ã¡nh thá»©c má»i váº­t tá»‰nh giáº¥c. CÃ¡nh Ä‘á»“ng lÃºa ... nhÆ° táº¥m tháº£m mÆ°á»£t mÃ  tráº£i rá»™ng mÃªnh mÃ´ng, tá»«ng sÃ³ng lÃºa ... trong giÃ³ nháº¹. Tiáº¿ng chim hÃ³t ... nhÆ° khÃºc nháº¡c vui tÆ°Æ¡i Ä‘Ã³n chÃ o ngÃ y má»›i.", gaps: [
        { label: "Sá»‘ (1)", opts: ["A. hoÃ ng hÃ´n", "B. ban mai", "C. chiá»u tÃ "], correct: "B. ban mai" },
        { label: "Sá»‘ (2)", opts: ["A. vÃ ng xuá»™m", "B. tráº¯ng phau", "C. xanh rÃ¬"], correct: "A. vÃ ng xuá»™m" },
        { label: "Sá»‘ (3)", opts: ["A. dáº­p dá»n", "B. tÃ­ tÃ¡ch", "C. nháº¥p nhÃ´"], correct: "A. dáº­p dá»n" },
        { label: "Sá»‘ (4)", opts: ["A. rÃ¬ rÃ o", "B. Ã¬ áº§m", "C. lÃ­u lo"], correct: "C. lÃ­u lo" }
    ], img: "15s4yfuXZe-g_nB9ZnGfnf0Bp2-zDefmV" },
    { id: 59, type: "mcq_multi", q: "Chá»n tá»« ngá»¯ thÃ­ch há»£p Ä‘iá»n vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n vÄƒn miÃªu táº£ bá»©c tranh sau: <br>Buá»•i sá»›m, Ã¡nh náº¯ng ... chiáº¿u xuá»‘ng, Ä‘Ã¡nh thá»©c khu rá»«ng mÃ¹a xuÃ¢n tá»‰nh giáº¥c. CÃ¢y cá»‘i xanh um, nhá»¯ng bÃ´ng hoa khoe sáº¯c rá»±c rá»¡, chim chÃ³c Ä‘ua nhau hÃ³t lÃ­u lo. DÃ²ng ... Ä‘Æ°á»£c náº¯ng chiáº¿u vÃ o, trÃ´ng xa nhÆ° dáº£i lá»¥a má»m máº¡i, ... Tiáº¿ng suá»‘i cháº£y ... nhÆ° báº£n nháº¡c du dÆ°Æ¡ng vang vá»ng nÆ¡i nÃºi rá»«ng.", gaps: [
        { label: "Sá»‘ (1)", opts: ["A. hoÃ ng hÃ´n", "B. ban mai", "C. xáº¿ chiá»u"], correct: "B. ban mai" },
        { label: "Sá»‘ (2)", opts: ["A. sÃ´ng", "B. kÃªnh", "C. thÃ¡c"], correct: "C. thÃ¡c" },
        { label: "Sá»‘ (3)", opts: ["A. thÆ°á»›t tha", "B. tháº³ng tháº¯n", "C. thoang thoáº£ng"], correct: "A. thÆ°á»›t tha" },
        { label: "Sá»‘ (4)", opts: ["A. lao xao", "B. rÃ³c rÃ¡ch", "C. lÃ¡ch tÃ¡ch"], correct: "B. rÃ³c rÃ¡ch" }
    ], img: "1thhQf-Yp9YQZwf96YGPvx3sVFJW3Se79" },
    { id: 60, type: "mcq_multi", q: "Chá»n tá»« ngá»¯ thÃ­ch há»£p Ä‘iá»n vÃ o chá»— trá»‘ng Ä‘á»ƒ hoÃ n thÃ nh Ä‘oáº¡n vÄƒn miÃªu táº£ hÃ¬nh áº£nh sau: <br>Buá»•i chiá»u, khung cáº£nh lÃ ng quÃª tháº­t ... Náº¯ng vÃ ng Ä‘ang dáº§n lui vá» phÃ­a sau ngá»n nÃºi. DÃ²ng sÃ´ng nÆ°á»›c cháº£y ... con thuyá»n nhá» xuÃ´i dÃ²ng vá» Ä‘áº­u báº¿n nghá»‰ ngÆ¡i. Hai bÃªn bá», tháº£m lÃºa ... dáº­p dá»n trong giÃ³ háº¡. ÄÃ n chim rÃ­u ran gá»i báº§y, ... bay vá» tá»• trÆ°á»›c khi trá»i tá»‘i.", gaps: [
        { label: "Sá»‘ (1)", opts: ["A. hoÃ ng sÆ¡", "B. yÃªn bÃ¬nh", "C. táº¥p náº­p"], correct: "B. yÃªn bÃ¬nh" },
        { label: "Sá»‘ (2)", opts: ["A. Ãªm Ä‘á»m", "B. cuá»“n cuá»™n", "C. Ã o áº¡t"], correct: "A. Ãªm Ä‘á»m" },
        { label: "Sá»‘ (3)", opts: ["A. vÃ ng vá»t", "B. vÃ ng lá»‹m", "C. vÃ ng xuá»™m"], correct: "C. vÃ ng xuá»™m" },
        { label: "Sá»‘ (4)", opts: ["A. lá»¯ng thá»¯ng", "B. há»‘i háº£", "C. lon ton"], correct: "B. há»‘i háº£" }
    ], img: "1fe5LjVGMkrZrBh_w9wD-pcPBFzg91nGG" }
];

const studentsMap = {
    "14041989": "Pháº¡m VÄƒn Chiáº¿n",
    "03032015": "Pháº¡m Nguyá»…n Tháº£o Huyá»n", 
    "15112015": "ÄoÃ n ÄÄƒng Khoa", 
    "24101994": "Äáº·ng Thá»‹ Kim Mai", 
};

// --- STATE ---
let currentUser = null, currentAuthUser = null, examQuestions = [], currentQuestionIndex = 0, userAnswers = {}, timeLeft = 30 * 60, timerId = null;

// --- AUTH LISTENER ---
if (firebaseAuth) {
    onAuthStateChanged(firebaseAuth, (user) => {
        currentAuthUser = user;
        if (user && currentUser) window.loadHistory();
    });
}

// --- CORE FUNCTIONS ---
const initAuth = async () => {
    if (!firebaseAuth) return;
    try {
        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
            await signInWithCustomToken(firebaseAuth, __initial_auth_token);
        } else {
            await signInAnonymously(firebaseAuth);
        }
    } catch (e) { console.error("XÃ¡c thá»±c lá»—i:", e); }
};

window.onload = () => initAuth();

function showScreen(id) {
    document.querySelectorAll('#app > div').forEach(d => d.classList.add('hidden-screen'));
    const t = document.getElementById(id);
    if (!t) return;
    t.classList.remove('hidden-screen');
    if (id === 'ready-screen' || id === 'result-screen') t.classList.add('flex');
}

function handleLogin() {
    const id = document.getElementById('student-id').value.toUpperCase().trim();
    if (studentsMap[id]) {
        currentUser = { id, name: studentsMap[id] };
        document.getElementById('display-name').textContent = currentUser.name;
        document.getElementById('welcome-msg').innerHTML = `ChÃ o má»«ng em, <b>${currentUser.name}</b>!`;
        showScreen('ready-screen');
    } else {
        document.getElementById('login-error').classList.remove('hidden');
    }
}

function startExam() {
    examQuestions = [...allQuestions].sort(() => 0.5 - Math.random()).slice(0, 30);
    userAnswers = {}; 
    currentQuestionIndex = 0; 
    timeLeft = 30 * 60;
    renderQuestionNav(); 
    showScreen('exam-screen'); 
    window.renderQuestion(); 
    startTimer();
}

function renderQuestion() {
    const q = examQuestions[currentQuestionIndex]; 
    if (!q) return;
    const container = document.getElementById('question-container');
    let html = '';
    
    if (q.img) {
        html += `<div class="mb-8 flex justify-center bg-slate-50 p-4 rounded-3xl border-2 border-dashed border-slate-200">
                    <img src="https://drive.google.com/thumbnail?id=${q.img}&sz=w1000" 
                         class="max-h-80 rounded-xl shadow-lg border-2 border-white ring-1 ring-slate-200" 
                         alt="Minh há»a" onerror="this.src='https://placehold.co/600x400?text=Äang+táº£i+hÃ¬nh+áº£nh...'">
                 </div>`;
    }

    html += `<div class="mb-6 text-sm font-bold text-blue-500 uppercase tracking-widest text-left">CÃ¢u há»i ${currentQuestionIndex + 1} / 30</div>`;

    if (q.type === 'fill') {
        let qText = q.q; let gi = 0;
        while (qText.includes("...") || qText.includes("[...]")) {
            const id = `${q.id}_gap_${gi}`;
            const target = qText.includes("[...]") ? "[...]" : "...";
            qText = qText.replace(target, `<input type="text" class="inline-input" value="${userAnswers[id] || ''}" oninput="window.saveAnswer('${id}', this.value)" placeholder="?">`);
            gi++;
        }
        html += `<div class="question-text text-slate-800 text-left">${qText}</div>`;
    } else if (q.type === 'error_fix') {
        html += `<div class="question-text mb-6 font-medium text-left">${q.q}</div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-red-50 p-6 rounded-2xl border border-red-100 shadow-sm">
                    <div class="text-left"><label class="error-label">Tá»« viáº¿t sai:</label>
                         <input type="text" class="w-full p-4 rounded-xl border focus:ring-2 focus:ring-red-400 outline-none" value="${userAnswers[`${q.id}_wrong`] || ''}" oninput="window.saveAnswer('${q.id}_wrong', this.value)" placeholder="VD: dá»i"></div>
                    <div class="text-left"><label class="error-label">Sá»­a láº¡i Ä‘Ãºng:</label>
                         <input type="text" class="w-full p-4 rounded-xl border focus:ring-2 focus:ring-red-400 outline-none" value="${userAnswers[`${q.id}_fixed`] || ''}" oninput="window.saveAnswer('${q.id}_fixed', this.value)" placeholder="VD: rá»i"></div>
                 </div>`;
    } else if (q.type === 'mcq') {
        html += `<div class="question-text mb-6 font-medium text-left">${q.q}</div><div class="space-y-4">`;
        q.options.forEach(opt => {
            const ok = userAnswers[q.id] === opt;
            html += `<label class="flex items-center p-5 border-2 rounded-2xl cursor-pointer hover:bg-blue-50 transition ${ok ? 'bg-blue-50 border-blue-500 ring-2 border-blue-200' : 'bg-white border-slate-100'}">
                <input type="radio" name="mcq" value="${opt}" ${ok ? 'checked' : ''} class="w-6 h-6 mr-4" onchange="window.saveAnswer('${q.id}', this.value); window.renderQuestion();">
                <span class="text-lg">${opt}</span></label>`;
        });
        html += `</div>`;
    } else if (q.type === 'mcq_multi') {
        html += `<div class="question-text mb-8 font-medium text-left">${q.q}</div><div class="space-y-8">`;
        q.gaps.forEach((g, i) => {
            const gid = `${q.id}_gap_${i}`;
            html += `<div class="bg-slate-50 p-6 rounded-2xl border border-slate-200 shadow-sm text-left">
                <div class="font-bold text-blue-700 mb-4 text-lg">Chá»— trá»‘ng ${g.label}</div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">`;
            g.opts.forEach(o => {
                const ok = userAnswers[gid] === o;
                html += `<label class="flex items-center p-4 bg-white border-2 rounded-xl cursor-pointer transition ${ok ? 'ring-4 ring-blue-500/20 border-blue-500' : ''}">
                    <input type="radio" name="${gid}" value="${o}" ${ok ? 'checked' : ''} onchange="window.saveAnswer('${gid}', this.value); window.renderQuestion();">
                    <span class="ml-3 font-medium">${o}</span></label>`;
            });
            html += `</div></div>`;
        });
        html += `</div>`;
    } else if (q.type === 'matching') {
        html += `<div class="question-text mb-6 font-medium text-left">${q.q}</div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                    <div class="text-left"><h4 class="font-bold text-slate-400 text-xs uppercase mb-4 tracking-widest text-center">Cá»™t trÃ¡i (KÃ©o)</h4><div class="flex flex-wrap gap-3 justify-center">`;
        q.items.forEach(item => {
            let used = false; for(let k in userAnswers) if(k.startsWith(q.id + '_match_') && userAnswers[k] === item) used = true;
            if(!used) html += `<div class="drag-item px-5 py-3 text-lg" draggable="true" ondragstart="window.handleDragStart(event, '${item}')">${item}</div>`;
        });
        html += `</div></div><div><h4 class="font-bold text-slate-400 text-xs uppercase mb-4 tracking-widest text-center">Cá»™t pháº£i (Tháº£)</h4><div class="space-y-5">`;
        q.targets.forEach((t, i) => {
            const mid = `${q.id}_match_${i}`; const val = userAnswers[mid];
            html += `<div class="p-5 bg-white rounded-2xl border-2 border-slate-100 shadow-sm text-left">
                <div class="text-slate-600 mb-3 leading-relaxed text-sm italic">${t}</div>
                <div class="drop-zone border-slate-200" ondragover="window.handleDragOver(event)" ondrop="window.handleDrop(event, '${mid}')">
                    ${val ? `<div class="drag-item bg-blue-600 text-white border-blue-700 w-full text-center" onclick="window.removeMatch('${mid}')">${val}</div>` : '<span class="text-slate-300 text-sm italic text-center w-full block">Tháº£ tá»« vÃ o Ä‘Ã¢y...</span>'}
                </div></div>`;
        });
        html += `</div></div></div>`;
    }
    container.innerHTML = html; 
    updateNavUI();
}

function updateNavUI() {
    document.querySelectorAll('.question-nav-btn').forEach((btn, i) => {
        const q = examQuestions[i]; if (!q) return;
        btn.classList.toggle('active', i === currentQuestionIndex);
        let done = false;
        if(q.type === 'fill') done = (q.q.match(/\.\.\.|\{\.\.\.\}/g) || []).every((_, gi) => !!userAnswers[`${q.id}_gap_${gi}`]);
        else if(q.type === 'error_fix') done = (!!userAnswers[`${q.id}_wrong`] && !!userAnswers[`${q.id}_fixed`]);
        else if(q.type === 'mcq_multi') done = q.gaps.every((_, gi) => !!userAnswers[`${q.id}_gap_${gi}`]);
        else if(q.type === 'matching') done = q.targets.every((_, ti) => !!userAnswers[`${q.id}_match_${ti}`]);
        else done = !!userAnswers[q.id];
        btn.classList.toggle('answered', done);
    });
    const pBtn = document.getElementById('prev-btn');
    const nBtn = document.getElementById('next-btn');
    if(pBtn) pBtn.disabled = currentQuestionIndex === 0;
    if(nBtn) nBtn.disabled = currentQuestionIndex === examQuestions.length - 1;
}

function renderQuestionNav() {
    const nav = document.getElementById('question-nav'); 
    if (!nav) return;
    nav.innerHTML = '';
    examQuestions.forEach((_, i) => {
        const b = document.createElement('button');
        b.className = 'question-nav-btn w-full aspect-square rounded-xl border-2 flex items-center justify-center font-bold text-sm bg-white transition shadow-sm';
        b.textContent = i + 1; b.onclick = () => { currentQuestionIndex = i; window.renderQuestion(); };
        nav.appendChild(b);
    });
}

function startTimer() {
    if (timerId) clearInterval(timerId); 
    timeLeft = 30 * 60;
    timerId = setInterval(() => {
        timeLeft--; 
        const m = Math.floor(timeLeft / 60), s = timeLeft % 60;
        const timerEl = document.getElementById('timer');
        if (timerEl) timerEl.textContent = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        if(timeLeft <= 0) { clearInterval(timerId); window.submitExam(); }
    }, 1000);
}

function submitExam() {
    clearInterval(timerId); 
    closeConfirm();
    let score = 0;
    examQuestions.forEach(q => {
        let ok = false;
        if (q.type === 'fill') {
            const cp = q.ans.split(',').map(s => s.trim().toLowerCase());
            ok = cp.every((p, i) => (userAnswers[`${q.id}_gap_${i}`] || '').trim().toLowerCase() === p);
        } else if (q.type === 'error_fix') {
            const [aw, af] = q.ans.split('-').map(s => s.trim().toLowerCase());
            ok = ((userAnswers[`${q.id}_wrong`] || '').trim().toLowerCase() === aw && (userAnswers[`${q.id}_fixed`] || '').trim().toLowerCase() === af);
        } else if (q.type === 'mcq') ok = (userAnswers[q.id] || '').includes(q.ans.charAt(0));
        else if (q.type === 'mcq_multi') ok = q.gaps.every((g, i) => userAnswers[`${q.id}_gap_${i}`] === g.correct);
        else if (q.type === 'matching') ok = q.items.every(item => userAnswers[`${q.id}_match_${q.ans[item]}`] === item);
        if (ok) score += 10;
    });
    document.getElementById('final-score').textContent = score;
    document.getElementById('result-summary').textContent = `Em Ä‘Ã£ Ä‘áº¡t ${score}/300 Ä‘iá»ƒm.`;
    
    if (firebaseAuth && currentAuthUser) {
        try { 
            addDoc(collection(firebaseDb, 'artifacts', appId, 'public', 'data', 'results'), { 
                studentId: currentUser.id, 
                score, 
                timestamp: new Date().toISOString() 
            }); 
            window.loadHistory(); 
        } catch (e) {}
    }
    showScreen('result-screen');
}

function loadHistory() {
    if (!firebaseDb || !currentUser) return;
    const list = document.getElementById('history-list');
    onSnapshot(query(collection(firebaseDb, 'artifacts', appId, 'public', 'data', 'results')), (snap) => {
        list.innerHTML = '';
        snap.docs.map(d => d.data())
            .filter(r => r.studentId === currentUser.id)
            .sort((a,b) => new Date(b.timestamp) - new Date(a.timestamp))
            .forEach(it => {
                const li = document.createElement('li');
                li.className = "flex justify-between bg-white p-5 rounded-2xl border shadow-sm";
                li.innerHTML = `<span>ğŸ“… ${new Date(it.timestamp).toLocaleString('vi-VN')}</span> <span class="font-black text-blue-600">${it.score} Ä‘iá»ƒm</span>`;
                list.appendChild(li);
            });
    });
}

function showReview() {
    const content = document.getElementById('review-content'); 
    content.innerHTML = '';
    examQuestions.forEach((q, i) => {
        let isCorrect = false, userVal = "", correctVal = q.ans;
        if(q.type === 'fill') {
            const gc = (q.q.match(/\.\.\.|\{\.\.\.\}/g) || []).length;
            const up = []; for(let j=0; j<gc; j++) up.push(userAnswers[`${q.id}_gap_${j}`] || "?");
            userVal = up.join(", ");
            isCorrect = q.ans.split(',').map(s=>s.trim().toLowerCase()).every((p, j) => (userAnswers[`${q.id}_gap_${j}`] || '').trim().toLowerCase() === p);
        } else if(q.type === 'error_fix') {
            const w = userAnswers[`${q.id}_wrong`] || "?", f = userAnswers[`${q.id}_fixed`] || "?";
            userVal = `Tá»« sai: ${w} - Sá»­a: ${f}`;
            const [aw, af] = q.ans.split('-').map(s=>s.trim().toLowerCase());
            isCorrect = (w.trim().toLowerCase() === aw && f.trim().toLowerCase() === af);
        } else if(q.type === 'mcq') { userVal = userAnswers[q.id] || "(ChÆ°a lÃ m)"; isCorrect = (userAnswers[q.id] || "").includes(q.ans.charAt(0)); }
        else if(q.type === 'mcq_multi') {
            userVal = q.gaps.map((_, j) => userAnswers[`${q.id}_gap_${j}`] || "?").join(" | ");
            correctVal = q.gaps.map(g => g.correct).join(" | ");
            isCorrect = q.gaps.every((g, j) => userAnswers[`${q.id}_gap_${j}`] === g.correct);
        } else if(q.type === 'matching') {
            userVal = q.targets.map((t, j) => {
                const item = userAnswers[`${q.id}_match_${j}`];
                return item ? `[${item} â†” ${t.substring(0, 20)}...]` : `[? â†” ${t.substring(0, 20)}...]`;
            }).join("<br>");
            correctVal = q.items.map(item => `[${item} â†” ${q.targets[q.ans[item]].substring(0, 20)}...]`).join("<br>");
            isCorrect = q.items.every(item => userAnswers[`${q.id}_match_${q.ans[item]}`] === item);
        }
        const d = document.createElement('div');
        d.className = `p-8 border-l-[12px] rounded-3xl bg-white shadow-md ${isCorrect ? 'border-green-500' : 'border-red-500'}`;
        d.innerHTML = `<div class="font-black mb-3 text-xl ${isCorrect ? 'text-green-700' : 'text-red-700'}">CÃ¢u ${i+1}: ${isCorrect ? 'ÄÃšNG' : 'CHÆ¯A ÄÃšNG'}</div>
                       <div class="mb-6 text-slate-700 leading-relaxed italic text-lg">${q.q.replace(/<input.*?>/g, "...")}</div>
                       <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="p-5 bg-slate-50 rounded-2xl border-2"><b>BÃ i lÃ m:</b> <div class="mt-2 font-bold ${isCorrect?'text-green-600':'text-red-500'}">${userVal}</div></div>
                            <div class="p-5 bg-blue-50 rounded-2xl border-2 border-blue-100"><b>ÄÃ¡p Ã¡n Ä‘Ãºng:</b> <div class="mt-2 font-bold text-blue-700">${correctVal}</div></div>
                       </div>`;
        content.appendChild(d);
    });
    document.getElementById('review-modal').classList.remove('hidden');
}

function closeReview() { document.getElementById('review-modal').classList.add('hidden'); }
function confirmSubmit() { document.getElementById('confirm-dialog').classList.remove('hidden'); }
function closeConfirm() { document.getElementById('confirm-dialog').classList.add('hidden'); }

// --- ATTACH TO WINDOW ---
window.handleLogin = handleLogin;
window.startExam = startExam;
window.renderQuestion = renderQuestion;
window.navQuestion = (dir) => { currentQuestionIndex += dir; window.renderQuestion(); };
window.saveAnswer = (id, val) => { userAnswers[id] = val; updateNavUI(); };
window.handleDragStart = (e, v) => e.dataTransfer.setData('text', v);
window.handleDragOver = (e) => e.preventDefault();
window.handleDrop = (e, id) => { const v = e.dataTransfer.getData('text'); if(v) { window.saveAnswer(id, v); window.renderQuestion(); } };
window.removeMatch = (id) => { delete userAnswers[id]; window.renderQuestion(); };
window.confirmSubmit = confirmSubmit;
window.closeConfirm = closeConfirm;
window.submitExam = submitExam;
window.showReview = showReview;
window.closeReview = closeReview;
window.loadHistory = loadHistory;

</script>
</body>
</html>